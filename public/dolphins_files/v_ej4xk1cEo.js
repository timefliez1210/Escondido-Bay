;/*FB_PKG_DELIM*/

__d("VideoPlayerIMFStickersOverlayRelayQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5859315677517462"}),null);
__d("VideoPlayerIMFStickersOverlayRelayQuery.graphql",["VideoPlayerIMFStickersOverlayRelayQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"scale"},{defaultValue:null,kind:"LocalArgument",name:"stickerRequests"},{defaultValue:null,kind:"LocalArgument",name:"videoId"}],c=[{kind:"Variable",name:"id",variableName:"videoId"}],d=[{kind:"Variable",name:"sticker_requests",variableName:"stickerRequests"}],e=[{kind:"Literal",name:"supported",value:["XFBVideoCometIMFFollowStickerRenderer","XFBVideoCometIMFCommentHighlightStickerRenderer"]}],f={kind:"InlineFragment",selections:[{args:null,documentName:"VideoPlayerIMFStickersOverlayRelayQuery",fragmentName:"VideoPlayerIMFFollowSticker_sticker_renderer",fragmentPropName:"sticker_renderer",kind:"ModuleImport"}],type:"XFBVideoCometIMFFollowStickerRenderer",abstractKey:null},g={kind:"InlineFragment",selections:[{args:null,documentName:"VideoPlayerIMFStickersOverlayRelayQuery",fragmentName:"VideoPlayerIMFCommentHighlightSticker_sticker_renderer",fragmentPropName:"sticker_renderer",kind:"ModuleImport"}],type:"XFBVideoCometIMFCommentHighlightStickerRenderer",abstractKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VideoPlayerIMFStickersOverlayRelayQuery",selections:[{alias:null,args:c,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[{alias:null,args:d,concreteType:"XFBVideoCometIMFSticker",kind:"LinkedField",name:"comet_imf_stickers",plural:!0,selections:[{alias:null,args:e,concreteType:null,kind:"LinkedField",name:"sticker_renderer",plural:!1,selections:[f,g],storageKey:'sticker_renderer(supported:["XFBVideoCometIMFFollowStickerRenderer","XFBVideoCometIMFCommentHighlightStickerRenderer"])'}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VideoPlayerIMFStickersOverlayRelayQuery",selections:[{alias:null,args:c,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[{alias:null,args:d,concreteType:"XFBVideoCometIMFSticker",kind:"LinkedField",name:"comet_imf_stickers",plural:!0,selections:[{alias:null,args:e,concreteType:null,kind:"LinkedField",name:"sticker_renderer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},f,g],storageKey:'sticker_renderer(supported:["XFBVideoCometIMFFollowStickerRenderer","XFBVideoCometIMFCommentHighlightStickerRenderer"])'}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:b("VideoPlayerIMFStickersOverlayRelayQuery_facebookRelayOperation"),metadata:{},name:"VideoPlayerIMFStickersOverlayRelayQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("VideoPlayerIMFModuleLazy",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";var h=c("JSResourceForInteraction")("VideoPlayerIMFModuleForLazyLoading").__setRef("VideoPlayerIMFModuleLazy"),i=null;a={getModuleIfRequireable:function(){return h.getModuleIfRequireable()},load:function(){i==null&&(i=h.load());return i}};b=a;g["default"]=b}),98);
__d("VideoPlayerIMFStateContainer",["ErrorMetadata","ErrorSerializer","FBLogger","VideoPlayerHooks","VideoPlayerIMFMetadataContext","VideoPlayerIMFModuleLazy","cr:4964","deepEquals","err","getErrorSafe","promiseDone","react","useVideoPlayerControllerSubscription"],(function(a,b,c,d,e,f,g){"use strict";e=d("react");var h=e.useDebugValue,i=e.useEffect,j=e.useRef,k=e.useState;e=(f=b("cr:4964"))!=null?f:{KnownEmsgSchemes:null};var l=e.KnownEmsgSchemes;function m(a,b,c){a.forEach(function(a){a.segments.forEach(function(d){var e=d.playheadRangeInSeconds,f=d.sticker;f!=null&&(e.from==null||e.from<=b)&&(e.to==null||b<=e.to)&&c.push({debugInfo:{segmentData:d.segmentData,trackData:a.trackData,trackName:a.trackName},sticker:f})})})}function n(a,b,c,d){m(a.tracks,b,d)}function o(a,b){return{debug_reason:null,error_user_info:JSON.stringify({emsgDataStr:b.emsgDataStr,emsgDurationInSec:b.emsgDurationInSec,emsgId:b.emsgId,emsgScheme:b.emsgScheme,emsgStartTimeInSec:b.emsgStartTimeInSec}),imf_emsg_id:b.emsgId!=null?String(b.emsgId):null,imf_topic:b.emsgScheme,offset_ms:b.emsgStartTimeInSec==null?null:a*1e3-b.emsgStartTimeInSec*1e3,representation_id:b.representationID}}function p(a,b,d,e,f,g,h){a=a.map(function(a){return a.type==="imf_live_sticker"?a:null}).filter(Boolean);var i=a[a.length-1];if(i!=null)try{e=e.parseVideoPlayerIMFSpecFromIMFLiveStickerEmsgBox(i);m(e.tracks,b,g)}catch(m){var j=c("getErrorSafe")(m);e=j.metadata||new(c("ErrorMetadata"))();d!=null&&e.addEntry("COMET_VIDEO","VIDEO_ID",d);e.addEntry("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({imf_live_sticker_emsg_boxes:a}));var k=j.errorName!=null&&j.errorName!==""?j.errorName:j.name,l=j.messageFormat!=null?j.messageFormat:j.message,n=(j.messageFormat!=null?(g=j.messageParams)!=null?g:[]:[]).slice(),p="CometVideoPlayerEmsgParseFailed",q=p+":"+(j.errorName!=null&&j.errorName!==""?j.errorName:j.name),r=c("ErrorSerializer").toReadableMessage(c("err").apply(void 0,[l].concat(n)));h.push(function(){var a;(a=c("FBLogger")("comet_video_player").catching(j)).warn.apply(a,["CometVideoPlayerIMFLiveStickerParseFailed:"+k+": "+l].concat(n))});h.push(function(){f==null?void 0:f(babelHelpers["extends"]({},o(b,i),{error:q,error_code:"0",error_description:r,error_domain:p,error_type:"GenericParseError",imf_event_type:"IMF_JSON_PARSE_FAILURE"}))})}}function q(a){var b=a.VideoPlayerIMFModuleLoaded,d=a.specInlineJson,e=a.videoID;return function(a,f){var g=a.getPlayheadPosition(),h=a.getCurrentState(),i=h.activeEmsgBoxes;if(f!=null&&g===f.playhead&&i===f.activeEmsgBoxes&&d===f.specInlineJson)return f;h=[];var j=[],k=d==null?null:f!=null&&d===f.specInlineJson?f.specFromVideoMetadata:function(){var a;a=(a=b)!=null?a:c("VideoPlayerIMFModuleLazy").getModuleIfRequireable();if(a!=null)try{return a.parseVideoPlayerIMFSpecFromVODInlineJSON(d)}catch(a){j.push(function(){var b=c("FBLogger")("comet_video_player");e!=null&&b.addMetadata("COMET_VIDEO","VIDEO_ID",e);b.addMetadata("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({imf_spec_inline_json:d}));b.catching(a);b.mustfix("Failed to parse IMF Inline JSON.")});return null}}();k!=null&&n(k,g,e,h);if(i.length>0){var m;m=(m=b)!=null?m:c("VideoPlayerIMFModuleLazy").getModuleIfRequireable();if(m!=null){var q=function(b){a.logVPLEvent_DO_NOT_USE("imf",b)};i!==(f==null?void 0:f.activeEmsgBoxes)&&i.forEach(function(a){a.emsgScheme!=null&&l!=null&&[l.LIVE_INSTREAM_ADS_SCHEME_ID,l.LIVE_STICKER_SCHEME_ID,l.LIVE_INTERACTIVE_PLUGIN_EVENT_ID].includes(a.emsgScheme)&&j.push(function(){q==null?void 0:q(babelHelpers["extends"]({},o(g,a),{imf_event_type:"IMF_RENDER"}))})});p(i,g,e,m,q,h,j)}else j.push(function(){var a=c("FBLogger")("comet_video_player");e!=null&&a.addMetadata("COMET_VIDEO","VIDEO_ID",e);a.addMetadata("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({active_emsg_boxes:i}));a.warn("VideoPlayerIMFModule is not available to parse active emsg boxes.")})}m={stickers:h};return f!=null&&c("deepEquals")(m,f.exposedState)?f:{activeEmsgBoxes:i,exposedState:m,playhead:g,sideEffects:j,specFromVideoMetadata:k,specInlineJson:d}}}function r(a){var b=k(a),c=b[0];b=b[1];c===!1&&a===!0&&b(!0);return c}function s(a){var b;a=a.videoPlayerIMFFromVideoMetadata;var e=r((b=a==null?void 0:a.imfExpectedFromEmsg)!=null?b:!1),f=a==null?void 0:a.specInlineJson;d("VideoPlayerHooks").useEmsgObserver(e);b=k(c("VideoPlayerIMFModuleLazy").getModuleIfRequireable());var g=b[0],l=b[1],m=j(null);i(function(){if(g==null&&m.current==null&&(e||f!=null)){var a=c("VideoPlayerIMFModuleLazy").load().then(function(b){if(m.current!==a)return;l(b)});c("promiseDone")(a);m.current=a;return function(){m.current=null}}},[g,e,f]);a=d("VideoPlayerHooks").useVideoFbid();var n=c("useVideoPlayerControllerSubscription")(q({VideoPlayerIMFModuleLoaded:g,specInlineJson:f,videoID:a}));h({useVideoPlayerIMFStateContainer:n});var o=j(null);i(function(){var a=n.sideEffects;a!==o.current&&(o.current=a,a.forEach(function(a){a()}))});return n}function a(){var a=d("VideoPlayerIMFMetadataContext").useVideoPlayerIMFMetadataFromContext();a=s({videoPlayerIMFFromVideoMetadata:a});return(a=a.exposedState)!=null?a:null}g.makeVideoPlayerIMFInternalStateUpdater=q;g.useVideoPlayerIMFStateContainerInternal=s;g.useVideoPlayerIMFStateContainer=a}),98);
__d("VideoPlayerIMFStickerErrors",["ErrorMetadata"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d){var e=new(c("ErrorMetadata"))();d!=null&&e.addEntry("COMET_VIDEO","VIDEO_ID",d);return{errorName:a,messageFormat:b+' in video "%s"',messageParams:[String(d)],metadata:e,project:"comet_video_player"}}function b(a,b,d,e){var f=new(c("ErrorMetadata"))();d!=null&&f.addEntry("COMET_VIDEO","VIDEO_ID",d);f.addEntry("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({imf_sticker_id:e.sticker.stickerId,imf_sticker_type:e.sticker.stickerType}));return{errorName:a,messageFormat:b+' with sticker "%s":"%s" in video "%s"',messageParams:[e.sticker.stickerType,e.sticker.stickerId,String(d)],metadata:f,project:"comet_video_player"}}g.makeVideoPlayerIMFAllStickersErrorContext=a;g.makeVideoPlayerIMFSingleStickerErrorContext=b}),98);
__d("useVideoPlayerIMFStickerTransform",["VideoPlayerHooks","react"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useDebugValue,i=b.useMemo;function j(a){return(100*a).toFixed(5)+"%"}function k(a){var b=a.containerAspectRatio,c=a.transform;a=a.videoPixelsAspectRatio;var d=1,e=d/b,f=1,g=f*b;e=b>=a?e:d;g=b>=a?f:g/a;e=b>=a?e*a:d;d=b>=a?(d-e)/2:0;b=b>=a?0:(f-g)/2;a=c.relativeX*e;f=c.relativeY*g;e=c.relativeWidth*e;g=c.relativeHeight*g;d=d+a;a=b+f;b=e;f=g;e=c.rotationDegrees;return{relativeHeight:f,relativeWidth:b,relativeX:d,relativeY:a,rotationDegrees:e}}function l(a,b){if(a==null||b==null)return{cssStyle:{display:"none"},stickerAspectRatio:null,stickerBox:null};var c=a.relativeHeight,d=a.relativeWidth,e=a.relativeX,f=a.relativeY;a=a.rotationDegrees;c={height:c*b.height,width:d*b.width};d=c.width/Math.max(c.height,1);b={boxSizing:"border-box",height:c.height*1.01,left:j(e),position:"absolute",top:j(f),transform:"rotate("+a.toFixed(5)+"deg)",transformOrigin:"50% 50%",width:c.width*1.005};return{cssStyle:b,stickerAspectRatio:d,stickerBox:c}}function a(a){a=a.stickerState;var b=d("VideoPlayerHooks").useDimensions(),c=b!=null?b.width/Math.max(b.height,1):null,e=d("VideoPlayerHooks").useVideoPixelsAspectRatio(),f=a.sticker.stickerTransform;a=i(function(){var a=c==null||e==null?null:k({containerAspectRatio:c,transform:f,videoPixelsAspectRatio:e}),d=l(a,b),g=d.cssStyle,h=d.stickerAspectRatio;d=d.stickerBox;return{containerAspectRatio:c,containerBox:b,cssStyle:g,stickerAspectRatio:h,stickerBox:d,transformNumbers:a,videoPixelsAspectRatio:(g=e)!=null?g:null}},[b,c,e,f]);h({containerAspectRatio:c,ret:a,transform:f,videoPixelsAspectRatio:e});return a}g.computeVideoPlayerIMFStickerTransformNumbers=k;g.computeVideoPlayerIMFStickerTransformCSSStyle=l;g.useVideoPlayerIMFStickerTransform=a}),98);
__d("VideoPlayerIMFStickerPressable.react",["CometPressable.react","react","requireDeferred","useSinglePartialViewImpression","useVideoPlayerIMFStickerTransform"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=c("requireDeferred")("LiveVideoOverlayStickerFalcoEvent").__setRef("VideoPlayerIMFStickerPressable.react");function a(a){var b=a.children,e=a.disabled,f=a.loggingInfo,g=a.onHoverChange,j=a.onPress,k=a.onPressChange,l=a.stickerState,m=a.style,n=a.xstyle;a=babelHelpers.objectWithoutPropertiesLoose(a,["children","disabled","loggingInfo","onHoverChange","onPress","onPressChange","stickerState","style","xstyle"]);var o=d("useVideoPlayerIMFStickerTransform").useVideoPlayerIMFStickerTransform({stickerState:l});o=o.cssStyle;var p=c("useSinglePartialViewImpression")({onImpressionStart:function(){i.onReady(function(a){a.log(function(){var a;return{event:"viewer_impression",overlay_id:l.sticker.stickerId,overlay_sub_type:(a=f.stickerSubtype)!=null?a:"Default",overlay_type:l.sticker.stickerType}})})}}),q=function(a){j&&j(a),i.onReady(function(a){a.log(function(){var a;return{event:"viewer_tap",overlay_id:l.sticker.stickerId,overlay_sub_type:(a=f.stickerSubtype)!=null?a:"Default",overlay_type:l.sticker.stickerType}})})};return h.jsx(c("CometPressable.react"),babelHelpers["extends"]({},a,{disabled:e===!0,expanding:!1,onHoverChange:g,onPress:q,onPressChange:k,overlayDisabled:!0,overlayRadius:0,ref:p,style:babelHelpers["extends"]({},m,o),xstyle:n,children:b}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerIMFStickerPlaceholderForError.react",["fbt","VideoPlayerIMFStickerPressable.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){a=a.stickerState;return i.jsx(c("VideoPlayerIMFStickerPressable.react"),{"aria-label":h._("__JHASH__K5eaGC7NX0i__JHASH__"),loggingInfo:{},onPress:function(){},stickerState:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerIMFStickerPlaceholderForSuspense.react",["fbt","VideoPlayerIMFStickerPressable.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){a=a.stickerState;return i.jsx(c("VideoPlayerIMFStickerPressable.react"),{"aria-label":h._("__JHASH__6lD-XyRyuHe__JHASH__"),loggingInfo:{},onPress:function(){},stickerState:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerIMFStickersOverlayRelay.react",["CometErrorBoundary.react","CometPlaceholder.react","CometRelay","VideoPlayerHooks","VideoPlayerIMFStickerErrors","VideoPlayerIMFStickerPlaceholderForError.react","VideoPlayerIMFStickerPlaceholderForSuspense.react","VideoPlayerIMFStickersOverlayRelayQuery.graphql","WebPixelRatio","cr:5089","emptyFunction","err","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react"),j=d("react").useMemo;e=(e=b("cr:5089"))!=null?e:{useVideoPlayerIMFStateContainer:c("emptyFunction")};var k=e.useVideoPlayerIMFStateContainer;function l(a){var e=a.stickerState,f=a.videoId;a=j(function(){var a;return{scale:d("WebPixelRatio").get(),stickerRequests:[{sticker_id:e.sticker.stickerId,sticker_type:e.sticker.stickerType}],videoId:(a=f)!=null?a:""}},[e.sticker.stickerId,e.sticker.stickerType,f]);a=d("CometRelay").useLazyLoadQuery(h!==void 0?h:h=b("VideoPlayerIMFStickersOverlayRelayQuery.graphql"),a,{fetchKey:e.sticker.stickerId,fetchPolicy:"store-or-network"});if(f==null)throw c("err")("Video ID is missing");if(a.video==null)throw c("err")("Video data is missing");a=a.video.comet_imf_stickers[0];if(a==null)throw c("err")("Sticker data is missing");a=a.sticker_renderer;if(a==null)throw c("err")("Sticker renderer is missing");return i.jsx(d("CometRelay").MatchContainer,{fallback:null,match:a,props:{stickerRenderer$key:a,stickerState:e,videoId:f}})}l.displayName=l.name+" [from "+f.id+"]";function m(){var a=d("VideoPlayerHooks").useVideoFbid(),b=k();return i.jsx(i.Fragment,{children:b==null?void 0:b.stickers.map(function(b){return i.jsx(c("CometErrorBoundary.react"),{context:d("VideoPlayerIMFStickerErrors").makeVideoPlayerIMFSingleStickerErrorContext("VideoPlayerIMFStickerFailedToRender","Failed to render sticker",a,b),fallback:function(a){return i.jsx(c("VideoPlayerIMFStickerPlaceholderForError.react"),{error:a,stickerState:b})},onError:function(a){},children:i.jsx(c("CometPlaceholder.react"),{fallback:i.jsx(c("VideoPlayerIMFStickerPlaceholderForSuspense.react"),{stickerState:b}),children:i.jsx(l,{stickerState:b,videoId:a},b.sticker.stickerId)})},b.sticker.stickerId)})})}m.displayName=m.name+" [from "+f.id+"]";function a(){var a=d("VideoPlayerHooks").useVideoFbid();return i.jsx(c("CometErrorBoundary.react"),{context:d("VideoPlayerIMFStickerErrors").makeVideoPlayerIMFAllStickersErrorContext("VideoPlayerIMFStickersOverlayRelayFailedToRender","Failed to render all stickers",a),fallback:function(){return null},onError:function(){},children:i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(m,{})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);